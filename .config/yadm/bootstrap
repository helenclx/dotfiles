#!/usr/bin/env bash

bootstrap_dir="$HOME/.config/yadm/bootstrap.d"

echo "Creating bootstrap logs directory..."
bootstrap_log_dir="$HOME/bootstrap-logs"
mkdir -p "$bootstrap_log_dir"

echo "Changing Bash configuration to the one in Helen Chong's yadm repo..."
yadm restore .bashrc

echo "Setting up the system locale..."
bash "$bootstrap_dir/locale.sh" >"$bootstrap_log_dir/locale.log"

echo "Installing software for these configuration files..."
echo "Installing packages from Arch Linux's repository..."
bash "$bootstrap_dir/pacman.sh" >"$bootstrap_log_dir/pacman.log"

echo "Compiling yay..."
bash "$bootstrap_dir/yay.sh" >"$bootstrap_log_dir/yay.log"

echo "Installing AUR packages for these config files..."
yay -S gpu-screen-recorder gpu-screen-recorder-ui >"$bootstrap_log_dir/gpu-screen-recorder.log"

echo "Setting up the Catppuccin global theme for KDE Plasma..."
bash "$bootstrap_dir/catppuccin-kde.sh" >"$bootstrap_log_dir/catppuccin-kde.log"

echo "Setting up the Catppuccin theme for tmux..."
bash "$bootstrap_dir/catppuccin-tmux.sh" >"$bootstrap_log_dir/catppuccin-tmux.log"

echo "Setting up Neovim..."
bash "$bootstrap_dir/neovim.sh" >"$bootstrap_log_dir/neovim.log"

echo "Updating Helen Chong's yadm repo origin URL..."
yadm remote set-url origin "git@git.helenchong.dev:helenchong/dotfiles.git"
echo "Updating Helen Chong's LazyVim configuration repo origin URL..."
cd "$HOME/.config/nvim" || return
git remote set-url origin "git@git.helenchong.dev:helenchong/LazyVim.git"
cd "$HOME" || return

echo "yadm bootstrap program executed. Check out $bootstrap_log_dir for logs."
echo "To complete the setup, select Fcitx 5 as the virtual keyboard in the system settings."
echo "Finally, reboot your system to apply changes."
